metadata:
  name: yolov5-tf-gpu
  namespace: cvat
  annotations:
    name: yolov5-tf-gpu
    type: detector
    framework: tensorflow
    spec: |
      [
        {"_id": 1, "name": "civic_2006"},
        {"_id": 2, "name": "altis_2014"},
        {"_id": 3, "name": "swift_2017"},
        {"_id": 4, "name": "march_2012"},
        {"_id": 5, "name": "tercel_1995"},
        {"_id": 6, "name": "yaris_2006"},
        {"_id": 7, "name": "csedan_2000"},
        {"_id": 8, "name": "ct_2011"},
        {"_id": 9, "name": "crv_2003"},
        {"_id": 10, "name": "outback_2014"},        
        {"_id": 11, "name": "savrin_2004"},
        {"_id": 12, "name": "kuga_2017"},
        {"_id": 13, "name": "focus5d_2008"},        
        {"_id": 14, "name": "tiida5d_2006"},        
        {"_id": 15, "name": "vios_2018"},
        {"_id": 16, "name": "altis_2017"},
        {"_id": 17, "name": "cefiro_1997"},
        {"_id": 18, "name": "glccoupe_2015"},       
        {"_id": 19, "name": "sienta_2017"},
        {"_id": 20, "name": "altis_2010"},
        {"_id": 21, "name": "morning_2015"},        
        {"_id": 22, "name": "ls_2018"},
        {"_id": 23, "name": "mondeometrostar_2000"},
        {"_id": 24, "name": "wish_2010"},
        {"_id": 25, "name": "sentra_2014"},
        {"_id": 26, "name": "chr_2017"},
        {"_id": 27, "name": "csedan_2014"},
        {"_id": 28, "name": "livina_2007"},
        {"_id": 29, "name": "xtrail_2015"},
        {"_id": 30, "name": "x3_2010"},
        {"_id": 31, "name": "wish_2004"},
        {"_id": 32, "name": "caddy_2011"},
        {"_id": 33, "name": "yaris_2015"},
        {"_id": 34, "name": "kuga_2014"},
        {"_id": 35, "name": "nx_2014"},
        {"_id": 36, "name": "mazda35d_2010"},
        {"_id": 37, "name": "xv_2017"},
        {"_id": 38, "name": "forester_2016"},
        {"_id": 39, "name": "focus5d_2005"},
        {"_id": 40, "name": "hrv_2017"},
        {"_id": 41, "name": "camry_2019"},
        {"_id": 42, "name": "coltplus_2017"},
        {"_id": 43, "name": "march_1993"},
        {"_id": 44, "name": "zinger_2016"},
        {"_id": 45, "name": "focus5d_2019"},
        {"_id": 46, "name": "mazda6_2014"},
        {"_id": 47, "name": "wish_2013"},
        {"_id": 48, "name": "globallancer_2003"},
        {"_id": 49, "name": "fit_2011"},
        {"_id": 50, "name": "innova_2012"},
        {"_id": 51, "name": "outlander_2007"},
        {"_id": 52, "name": "crv_2017"},
        {"_id": 53, "name": "vios_2014"},
        {"_id": 54, "name": "csedan_2007"},
        {"_id": 55, "name": "rav4_2016"},
        {"_id": 56, "name": "rx_2016"},
        {"_id": 57, "name": "model3_2019"},
        {"_id": 58, "name": "livina_2014"},
        {"_id": 59, "name": "xc40_2019"},
        {"_id": 60, "name": "swift_2005"},
        {"_id": 61, "name": "altis_2019"},
        {"_id": 62, "name": "crv_2007"},
        {"_id": 63, "name": "corollasport_2019"},
        {"_id": 64, "name": "savrin_2001"},
        {"_id": 65, "name": "mondeo_2015"},
        {"_id": 66, "name": "fit_2015"},
        {"_id": 67, "name": "altis_2006"},
        {"_id": 68, "name": "ahatchback_2016"},
        {"_id": 69, "name": "tiida5d_2013"},
        {"_id": 70, "name": "vios_2003"},
        {"_id": 71, "name": "altis_2008"},
        {"_id": 72, "name": "rav4_2008"},
        {"_id": 73, "name": "impreza5d_2017"},
        {"_id": 74, "name": "golf_2009"},
        {"_id": 75, "name": "golf_2018"},
        {"_id": 76, "name": "juke_2014"},
        {"_id": 77, "name": "lancerfortis_2015"},
        {"_id": 78, "name": "coltplus_2014"},
        {"_id": 79, "name": "mazda5_2010"},
        {"_id": 80, "name": "cefiro_2002"},
        {"_id": 81, "name": "focus5d_2013"},
        {"_id": 82, "name": "sx4hatchback_2006"},
        {"_id": 83, "name": "accord_2008"},
        {"_id": 84, "name": "u6_2014"},
        {"_id": 85, "name": "swift_2011"},
        {"_id": 86, "name": "tucson_2016"},
        {"_id": 87, "name": "outlander_2015"},
        {"_id": 88, "name": "veryca_2000"},
        {"_id": 89, "name": "xc60_2017"},
        {"_id": 90, "name": "ssedan_2010"},
        {"_id": 91, "name": "superbcombi_2016"},
        {"_id": 92, "name": "3touring_2016"},
        {"_id": 93, "name": "mondeo_2008"},
        {"_id": 94, "name": "esedan_2013"},
        {"_id": 95, "name": "es_2013"},
        {"_id": 96, "name": "ecosport_2019"},
        {"_id": 97, "name": "solio_2002"},
        {"_id": 98, "name": "protege_2000"},
        {"_id": 99, "name": "forester_2018"},
        {"_id": 100, "name": "gs_2019"},
        {"_id": 101, "name": "cx5_2018"},
        {"_id": 102, "name": "mazda6wagon_2017"},
        {"_id": 103, "name": "kamiq_2020"},
        {"_id": 104, "name": "camry_2006"},
        {"_id": 105, "name": "tiida4d_2006"},
        {"_id": 106, "name": "forester_2013"},
        {"_id": 107, "name": "yaris_2018"},
        {"_id": 108, "name": "city_2014"},
        {"_id": 109, "name": "fabia_2016"},
        {"_id": 110, "name": "bluebird_2006"},
        {"_id": 111, "name": "focus5d_2016"},
        {"_id": 112, "name": "accord_2002"},
        {"_id": 113, "name": "escape_2001"},
        {"_id": 114, "name": "x1_2016"},
        {"_id": 115, "name": "grander_2004"},
        {"_id": 116, "name": "fiesta_2009"},
        {"_id": 117, "name": "coltplus_2007"},
        {"_id": 118, "name": "xtrail_2002"},
        {"_id": 119, "name": "zacesurf_1999"},
        {"_id": 120, "name": "camry_2009"},
        {"_id": 121, "name": "a1_2011"},
        {"_id": 122, "name": "x3_2018"},
        {"_id": 123, "name": "carens_2015"},
        {"_id": 124, "name": "rx_2013"},
        {"_id": 125, "name": "previa_2006"},
        {"_id": 126, "name": "kuga_2020"},
        {"_id": 127, "name": "ix35_2010"},
        {"_id": 128, "name": "corolla_1987"},
        {"_id": 129, "name": "ahatchback_2019"},
        {"_id": 130, "name": "escort_2018"},
        {"_id": 131, "name": "2tourer_2015"},
        {"_id": 132, "name": "crv_2013"},
        {"_id": 133, "name": "golf_2003"},
        {"_id": 134, "name": "tiida5d_2017"},
        {"_id": 135, "name": "sx4hatchback_2013"},
        {"_id": 136, "name": "camry_2015"},
        {"_id": 137, "name": "camry_2002"},
        {"_id": 138, "name": "mclass_2012"},
        {"_id": 139, "name": "prius_2016"},
        {"_id": 140, "name": "q3_2012"},
        {"_id": 141, "name": "civic_2012"},
        {"_id": 142, "name": "focus4d_2013"},
        {"_id": 143, "name": "fit_2008"},
        {"_id": 144, "name": "vitara_2017"},
        {"_id": 145, "name": "cx3_2016"},
        {"_id": 146, "name": "elantra_2012"},
        {"_id": 147, "name": "jimny_2000"},
        {"_id": 148, "name": "bclass_2012"},
        {"_id": 149, "name": "santafe_2011"},
        {"_id": 150, "name": "mazda34d_2004"},
        {"_id": 151, "name": "miniclubman_2006"},
        {"_id": 152, "name": "veryca_2018"},
        {"_id": 153, "name": "glc_2016"},
        {"_id": 154, "name": "rav4_2013"},
        {"_id": 155, "name": "golf_2013"},
        {"_id": 156, "name": "touareg_2002"},
        {"_id": 157, "name": "matrix_2003"},
        {"_id": 158, "name": "lancerfortis_2007"},
        {"_id": 159, "name": "x_2015"},
        {"_id": 160, "name": "hrv_2020"},
        {"_id": 161, "name": "touran_2016"},
        {"_id": 162, "name": "kicks_2019"},
        {"_id": 163, "name": "508_2015"},
        {"_id": 164, "name": "mazda34d_2010"},
        {"_id": 165, "name": "mazda5_2005"},
        {"_id": 166, "name": "sentra_2000"},
        {"_id": 167, "name": "s60_2011"},
        {"_id": 168, "name": "es_2016"},
        {"_id": 169, "name": "caddy_2016"},
        {"_id": 170, "name": "camry_2012"},
        {"_id": 171, "name": "focus_2008"},
        {"_id": 172, "name": "mazda35d_2015"},
        {"_id": 173, "name": "xc60_2008"},
        {"_id": 174, "name": "polo_2006"},
        {"_id": 175, "name": "focus4d_2005"},
        {"_id": 176, "name": "x6_2008"},
        {"_id": 177, "name": "sentra_2018"},
        {"_id": 178, "name": "outlander_2017"},
        {"_id": 179, "name": "rav4_2019"},
        {"_id": 180, "name": "ssedan_2017"},
        {"_id": 181, "name": "tribute_2005"},
        {"_id": 182, "name": "escape_2006"},
        {"_id": 183, "name": "tiguan_2017"},
        {"_id": 184, "name": "accord_1998"},
        {"_id": 185, "name": "jimny_2019"},
        {"_id": 186, "name": "308_2015"},
        {"_id": 187, "name": "elantra_2017"},
        {"_id": 188, "name": "cx5_2013"},
        {"_id": 189, "name": "discovery4_2010"},
        {"_id": 190, "name": "camry_2004"},
        {"_id": 191, "name": "sirion_2007"},
        {"_id": 192, "name": "is_2009"},
        {"_id": 193, "name": "es_2018"},
        {"_id": 194, "name": "5sedan_1995"},
        {"_id": 195, "name": "es_2007"},
        {"_id": 196, "name": "teana_2004"},
        {"_id": 197, "name": "m7_2009"},
        {"_id": 198, "name": "rx_2003"},
        {"_id": 199, "name": "cla_2013"},
        {"_id": 200, "name": "mazda5_2012"},
        {"_id": 201, "name": "3sedan_2016"},
        {"_id": 202, "name": "minicountryman_2011"},
        {"_id": 203, "name": "is_2017"},
        {"_id": 204, "name": "cayenne_2002"},
        {"_id": 205, "name": "u7_2010"},
        {"_id": 206, "name": "5sedan_2010"},
        {"_id": 207, "name": "eclipsecross_2018"},
        {"_id": 208, "name": "rclass_2011"},
        {"_id": 209, "name": "ct_2018"},
        {"_id": 210, "name": "mazda34d_2019"},
        {"_id": 211, "name": "soul_2015"},
        {"_id": 212, "name": "1series_2016"},
        {"_id": 213, "name": "5008_2011"},
        {"_id": 214, "name": "accord_2006"},
        {"_id": 215, "name": "coronapremio_1996"},
        {"_id": 216, "name": "urx_2020"},
        {"_id": 217, "name": "golfplus_2010"},
        {"_id": 218, "name": "superbsedan_2016"},
        {"_id": 219, "name": "santafe_2007"},
        {"_id": 220, "name": "corolla_1991"},
        {"_id": 221, "name": "7series_2012"},
        {"_id": 222, "name": "1series_2012"},
        {"_id": 223, "name": "ux_2019"},
        {"_id": 224, "name": "rapid_2014"},
        {"_id": 225, "name": "mazda2_2016"},
        {"_id": 226, "name": "mazda34d_2015"},
        {"_id": 227, "name": "premacy_2001"},
        {"_id": 228, "name": "v50_2009"},
        {"_id": 229, "name": "rogue_2009"},
        {"_id": 230, "name": "focus4d_2016"},
        {"_id": 231, "name": "hilux_2020"},
        {"_id": 232, "name": "q3_2020"},
        {"_id": 233, "name": "x1_2010"},
        {"_id": 234, "name": "elantraex_2015"},
        {"_id": 235, "name": "cayenne_2010"},
        {"_id": 236, "name": "is_2001"},
        {"_id": 237, "name": "fabia_2011"},
        {"_id": 238, "name": "q30_2016"},
        {"_id": 239, "name": "globallancer_2007"},
        {"_id": 240, "name": "ls_2013"},
        {"_id": 241, "name": "focus4d_2019"},
        {"_id": 242, "name": "priusc_2018"},
        {"_id": 243, "name": "esedan_2009"},
        {"_id": 244, "name": "esedan_2016"},
        {"_id": 245, "name": "s3_2016"},
        {"_id": 246, "name": "v40_2013"},
        {"_id": 247, "name": "coronapremio_2000"},
        {"_id": 248, "name": "escape_2008"},
        {"_id": 249, "name": "discovery3_2005"},
        {"_id": 250, "name": "ls_2007"},
        {"_id": 251, "name": "mazda35d_2019"},
        {"_id": 252, "name": "sportage_2016"},
        {"_id": 253, "name": "208_2013"},
        {"_id": 254, "name": "v60_2012"},
        {"_id": 255, "name": "7series_2009"},
        {"_id": 256, "name": "m7_2010"},
        {"_id": 257, "name": "bclass_2008"},
        {"_id": 258, "name": "xc90_2009"},
        {"_id": 259, "name": "teana_2009"},
        {"_id": 260, "name": "odyssey_2015"},
        {"_id": 261, "name": "liana_2005"},
        {"_id": 262, "name": "innova_2008"},
        {"_id": 263, "name": "ssedan_2006"},
        {"_id": 264, "name": "sx4hatchback_2017"},
        {"_id": 265, "name": "odyssey_2018"},
        {"_id": 266, "name": "corollacross_2020"},
        {"_id": 267, "name": "altis_2001"},
        {"_id": 268, "name": "altima_2020"},
        {"_id": 269, "name": "u7_2015"},
        {"_id": 270, "name": "sienna_2014"},
        {"_id": 271, "name": "imax_2009"},
        {"_id": 272, "name": "cayenne_2015"},
        {"_id": 273, "name": "m_2010"},
        {"_id": 274, "name": "lancerfortis_2012"},
        {"_id": 275, "name": "ssedan_1999"},
        {"_id": 276, "name": "ecoupe_2014"},
        {"_id": 277, "name": "s5_2012"},
        {"_id": 278, "name": "q50_2014"},
        {"_id": 279, "name": "prius_2012"},
        {"_id": 280, "name": "cayenne_2006"},
        {"_id": 281, "name": "cayenne_2018"},
        {"_id": 282, "name": "eurostar_2004"},
        {"_id": 283, "name": "sentra_2003"},
        {"_id": 284, "name": "5sedanm5_2013"},
        {"_id": 285, "name": "slkclass_2005"},
        {"_id": 286, "name": "mazda2_2008"},
        {"_id": 287, "name": "corsa_2000"},
        {"_id": 288, "name": "is_2013"}
      ]

spec:
  description: yolov5-tf-gpu
  runtime: "python:3.6"
  handler: main:handler
  eventTimeout: 30s

  build:
    image: dorahero2727/cvat-cu11:v2
    baseImage: dorahero2727/cvat-cu11:v1

    directives:
      preCopy:
        - kind: WORKDIR
          value: /opt/nuclio

      postCopy:
        - kind: RUN
          value: pip install torch==1.7.1+cu110 torchvision==0.8.2+cu110 torchaudio===0.7.2 -f https://download.pytorch.org/whl/torch_stable.html
        - kind: ENV
          value: CUDA_VISIBLE_DEVICES=1

  triggers:
    myHttpTrigger:
      maxWorkers: 2
      kind: "http"
      workerAvailabilityTimeoutMilliseconds: 10000
      attributes:
        maxRequestBodySize: 33554432 # 32MB

  platform:
    attributes:
      restartPolicy:
        name: always
        maximumRetryCount: 3
